<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Meneige boekhouding</title>

  <!-- PWA -->
  <link rel="manifest" href="/Boekhouding/manifest.json">
  <meta name="theme-color" content="#2563eb">
  <meta name="description" content="Eenvoudige boekhouding PWA">

  <!-- Apple support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Boekhouding">

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    #authOverlay {
      position: fixed;
      inset: 0;
      background: #0f172a;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      flex-direction: column;
    }
    #authOverlay button {
      margin-top: 20px;
      padding: 12px 20px;
      font-size: 16px;
    }
    #logoutBtn {
      position: fixed;
      bottom: 10px;
      right: 10px;
      z-index: 500;
    }
  </style>
</head>

<body>

<!-- üîê LOGIN OVERLAY -->
<div id="authOverlay">
  <h2>üîê Beveiligde toegang</h2>
  <p>Log in om verder te gaan</p>
  <button class="btn primary" id="loginBtn">
    <i class="fab fa-google"></i> Inloggen met Google
  </button>
</div>

<button id="logoutBtn" class="btn secondary" style="display:none">
  Uitloggen
</button>

<header>
  <h1><i class="fas fa-wallet"></i> Meneige boekhouding</h1>
  <div id="saldoBox">
    <i class="fas fa-coins"></i> Huidig Saldo: <span id="saldo">‚Ç¨ 0.00</span>
  </div>
</header>

<main>
  <div class="btn-group">
    <button class="btn primary" onclick="openModal()">
      <i class="fas fa-plus-circle"></i> Nieuwe invoer
    </button>
    <button class="btn secondary" onclick="window.location.href='overzicht.html'">
      <i class="fas fa-table"></i> Overzicht
    </button>
  </div>
</main>

<!-- Modal -->
<div id="modal" class="modalHidden">
  <div class="modalContent">
    <h2>Nieuwe Invoer</h2>

    <label>Soort:</label>
    <select id="soort">
      <option value="inkomst">Inkomst</option>
      <option value="uitgave">Uitgave</option>
    </select>

    <label>Datum:</label>
    <input type="date" id="datum" />

    <label>Bedrag:</label>
    <input type="number" id="bedrag" placeholder="Bijv. 1200.00" />

    <label>
      <input type="checkbox" id="recurring" />
      Terugkerende maandelijkse kost
    </label>

    <label>Type:</label>
    <select id="type">
      <option>Loon</option>
      <option>Premie</option>
      <option>Extra vergoeding</option>
      <option>Terugbetaling</option>
      <option>Lening</option>
      <option>Verzekering</option>
      <option>Sparen</option>
      <option>Sparen Loreana</option>
      <option>Winkel</option>
      <option>Dokter</option>
      <option>Data</option>
      <option>Restaurant</option>
      <option>Auto</option>
      <option>Abonnementen</option>
      <option>Diverse</option>
    </select>

    <div class="modalBtns">
      <button class="btn cancel" onclick="closeModal()">Annuleren</button>
      <button class="btn primary" onclick="saveEntry()">Opslaan</button>
    </div>
  </div>
</div>

<script src="script.js"></script>

<!-- üî• FIREBASE AUTH -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getAuth,
  signInWithPopup,
  GoogleAuthProvider,
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

/* üî¥ VERVANG DIT MET JOUW FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyAkBAw17gNU_EBhn8dKgyY5qv-ecfWaG2s",
  authDomain: "finance-jonas.firebaseapp.com",
  projectId: "finance-jonas",
  storageBucket: "finance-jonas.firebasestorage.app",
  messagingSenderId: "497182804753",
  appId: "1:497182804753:web:ea942a578dd1c15f631ab0",
  measurementId: "G-0J29T1Z7MV"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();

/* üî¥ NA EERSTE LOGIN JE UID HIER PLAKKEN */
const ALLOWED_UID = "lB01qe1JQtV00aP50FkWzckJhmJ2";

const overlay = document.getElementById("authOverlay");
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");

loginBtn.onclick = () => signInWithPopup(auth, provider);
logoutBtn.onclick = () => signOut(auth);

onAuthStateChanged(auth, user => {
  if (user && user.uid === ALLOWED_UID) {
    overlay.style.display = "none";
    logoutBtn.style.display = "block";
  } else {
    overlay.style.display = "flex";
    logoutBtn.style.display = "none";
  }
});
</script>

<!-- SERVICE WORKER -->
<script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("/Boekhouding/service-worker.js");
  });
}
</script>

</body>
</html>
